/* rewritten by pts@fazekas.hu at Fri Jun 29 23:42:40 CEST 2001 */

/* used library functions */
#define putcha putchar
#define getcha getchar
#define mallo  malloc
#define fre    free
#include <stdio.h> /* putchar(), getchar() */
#include <stdlib.h> /* malloc(), free() */

/* used integer types, except for main() */
#define BYTE unsigned char /* 8 bits */
#define WORD unsigned short /* >=16 bits */
#define DWORD unsigned long /* >=32 bits */

/* Compiles with: gcc -ansi -pedantic -W -Wall -Wstrict-prototypes -Wtraditional -Wnested-enodeterns -Wpointer-arith -Wbad-function-cast -Wcast-qual -Wmissing-prototypes -Winline -Wmissing-declarations rcm.c */

int main(int argc, char **argv);
WORD B(WORD l, WORD O);

WORD
  W[] =
{16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15}, u[] =
{3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258},
  P[] =
{0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0},
  Q[] =
{1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577},
  L[] =
{0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13},
  y, C, t, Z[320], b[17], G[17];
DWORD j;
BYTE S[32768];
struct node {
  struct node *left, *right;
  WORD value;
} F, *V, *h, *I, **e;

WORD B (WORD l, WORD whichcode) {
  WORD w = 0, o, f, q;
  if (whichcode==0) {
    B (24, 1);
    o = B (8, 1);
    B (24, 1);
    B (24, 1);
    if (o & 4) {
      for (q = B (16, 1); q--; B (8, 1)) ;
    }; 
    for (; o & 8 && B (8, 1);) ;
    for (; o & 16 && B (8, 1);) ;
    if (o & 2) B (16, 1);
    for (o = 0; !o;) {
      o = B (1, 1);
      q = B (2, 1);
      if (q || B (8, 7)) {
        if (q & 1) B (7, 8);
        if (q & 2) B (3, 9);
        B (5, 6);
        I = V;
        B (2, 4);
        I = h;
        B (9, 4);
      }
    }
    for (; (C %= 32768) != (t %= 32768); putcha (C++[S]));
  } else if (whichcode == 6) {
    for (; (whichcode = B (6, (I = V, 3))) != 256;)
      if (whichcode > 256 || (B (whichcode, 2), 0)) {
        whichcode -= 257;
	l = u[whichcode] + B (P[whichcode], 1);
	I = h;
	whichcode = B (5, 3);
	whichcode = Q[whichcode] + B (L[whichcode], 1);
	whichcode = whichcode <= t ? t - whichcode : 32768 - whichcode + t;
	for (; l--; whichcode %= 32768) B (S[whichcode++], 2);
      }
  } else if (whichcode == 3) {
    for (; I->left; I = B (1, 1) ? I->right : I->left);
    w = I->value;
  } else if (whichcode == 5) {
    for (whichcode = 17; whichcode--; whichcode[b] = 0);
    for (whichcode++; whichcode < l; whichcode++[Z][b]++);
    for (*b = *G = whichcode = 0; whichcode < 16; whichcode++) {
      G[whichcode + 1] = (whichcode[G] + b[whichcode]) << 1;;
    }
    for (I = 0, whichcode = 0; whichcode < l; whichcode++) if (Z[whichcode]) {
      e = (q = whichcode[Z][G], Z[whichcode][G]++, o = Z[whichcode], &I);
      for (;
           o-- && (*e || ((*(*e = mallo (sizeof (struct node))) = F), 1));
           e = ((q >> o) & 1) ? &(*e)->right : &(*e)->left
           );
      *(*e = mallo (sizeof (struct node))) = F;
      (*e)->value = whichcode;
    }
  } else if (whichcode == 2) {
    t++[S] = l;
    if ((t %= 32768) == (C %= 32768)) putcha (C++[S]);
  } else if (whichcode == 8) {
    for (whichcode = 288; whichcode--; Z[whichcode] = whichcode < 144 ? 8 : whichcode < 256 ? 9 : whichcode < 280 ? 7 : 8);
    V = (B (288, 5), I);
    for (whichcode = 32; whichcode--; Z[whichcode] = 5);
    h = (B (32, 5), I);
  } else if (whichcode == 1 && l) {
    for (; y < l; y += 8) j |= (0l + getcha ()) << y;
    w = j & ((1 << l) - 1);
    j >>= l;
    y -= l;
  } else if (whichcode == 7) {
    if (y % 8) B (y % 8, 1);
    for (whichcode = B (16, 1), B (16, 1); whichcode--; B (B (8, 1), 2));
  } else if (whichcode == 9) {
    WORD p = B (5, 1) + 257, z = B (5, 1) + 1, v = B (4, 1) + 4;
    for (whichcode = 0; whichcode < v; whichcode++[W][Z] = B (3, 1));
    for (; 19 > whichcode; W[whichcode++][Z] = 0);
    V = (B (19, 5), I);
    for (l = whichcode = 0; whichcode < (p + z);) {
      I = V;
      o = B (3, 3);
      f = o == 16
        ? (o = l), 3 + B (2, 1) : o == 17 ?
        (o = 0), 3 + B (3, 1) : o == 18 ? (o = 0),
        11 + B (7, 1) : ((l = o), 1);
      for (q = f; q--; whichcode++[Z] = o);
    }
    I = V;
    B (9, 4);
    V = (B (p, 5), I);
    for (whichcode = z; whichcode--; Z[whichcode] = Z[whichcode + p]);
    h = (B (z, 5), I);
  } else if (whichcode == 4) {
    struct node *i = I;
    if (i) {
      I = i->left;
      B (7, 4);
      I = i->right;
      fre(i);
      B (1, 4);
    }
  }
  return w;
}

int main(int argc, char **argv) {
  (void)argc;
  (void)argv;
  return B(3, 0);
}
